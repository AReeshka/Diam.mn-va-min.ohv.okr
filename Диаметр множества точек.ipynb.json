{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Диаметр множества точек(вращающиеся калиперы)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "В этом билете мы рассмотрим задачу о нахождении из множества точек $P$ двух самых удаленных друг от друга. Назовем это расстояние **диаметром**($d$) множества точек."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": true
   },
   "source": [
    "**Вращающиеся калиперы** – это несложный паттерн \n",
    "проектирования различных алгоритмом, требующих последовательного обхождения выпуклых многоугольников в $\\mathbb{R}^2$. Рассмотрим применение метода на нашей задаче."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": true
   },
   "source": [
    "**Лемма 1.** *Диаметр множества лежит на выпуклой оболочке этого множества*"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": true
   },
   "source": [
    "*Доказательство.* Докажем от противного.  \n",
    "Пусть мы нашли диаметр множства $d(P)=dist(a,b)$, причем, не теряя общности, $b\\not\\in CH(P)$. Тогда утверждается, что можно пустить луч $ab$ и посмотреть, в какой точке он пересечет выпуклую оболочку. Легко показать, что как минимум одна точка, формирующая ребро выпуклой оболочки, пересеченное лучем, имеет дистанцию до $a$ больше $d(P)$. Ч.т.д."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": true
   },
   "source": [
    "Исходя из Леммы 1, диаметр можно искать только на выпуклой оболочке."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Давайте построим выпуклую оболочку для 30 случайных точек в двумерном пространстве."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "from scipy.spatial import ConvexHull\n",
    "points = np.random.rand(30, 2)   # 30 случайных точек в двумерном пространстве\n",
    "hull = ConvexHull(points)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\nMEnyQgjhwv4/wqoVtvH17Q8AAAAASUVORK5CYII=\n",
      "text/plain": [
       "<matplotlib.figure.Figure at 0x10afc5748>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "plt.plot(points[:,0], points[:,1], 'o')\n",
    "for simplex in hull.simplices:\n",
    "   plt.plot(points[simplex,0], points[simplex,1], 'k-')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": true
   },
   "source": [
    "**Переформулировка задачи.** Пусть $P = (p_1, p_2, ... ,p_n)$ — выпуклый многоугольник, в котором порядок обхода вершин направлен против часовой стрелки, и никакие три последовательные точки не лежат на одной прямой. Найти пару чисел $\\langle i$, $j \\rangle$, такие, что $d(p_i, p_j)$ максимально."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Прямая $L$ называется **опорной прямой** *(англ. line of support)* для многоугольника $P$, если его внутренность лежит по одну сторону от $L$, при этом $L$ проходит хотя бы через одну из вершин $P$."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**Теорема 1.** Пусть $L_1$ и $L_2$ — две параллельные опорные прямые (калиперы) фигуры $P$, расстояние между которыми имеет максимальное значение. $A_1$ и $A_2$ — граничные точки фигуры $P$, принадлежащие соответственно прямым $L_1$ и $L_2$. Тогда отрезок $A_1A_2$ перпендикулярен обеим прямым $L_1$ и $L_2$."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "*Доказательство.* Докажем от противного.  \n",
    "Пусть $A_1A_2$ не перпендикулярен обеим прямым $L_1$ и $L_2$. Тогда расстояние между прямыми $L_1$ и $L_2$ было бы меньше, чем отрезок $A_1A_2$, и тем более меньше, чем расстояние между двумя опорными прямыми $L'_1$ и $L'_2$ фигуры $P$, перпендикулярными к отрезку $A_1A_2$, что противоречит условию. Ч.т.д.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**Следствие 1.** Каждая из $L_1$ и $L_2$ содержит единственную граничную точку фигуры $P$."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "*Доказательство.* Так как $A_1$ и $A_2$ — какие угодно граничные точки фигуры $P$, принадлежащие соответственно прямым $L_1$ и $L_2$, то из перпендикулярности отрезка $A_1A_2$ к прямым $L_1$ и $L_2$ следует, что ни одна из прямых $L_1$, $L_2$ не может иметь с фигурой $P$ целый общий отрезок."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**Теорема 2.** Диаметр выпуклого многоугольника равен максимальному расстоянию между параллельными опорными прямыми."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "*Доказательство.* Пусть $P$ — выпуклая фигура, $L_1$ и $L_2$ — параллельные опорные прямые, расстояние между которыми имеет наибольшее возможное значение $d$, $A_1$ и $A_2$ — общие точки фигуры $P$ и прямых $L_1$ и $L_2$ соответственно. По предыдущей теореме $A_1A_2$ перпендикулярен к прямым $L_1$, $L_2$, следовательно, его длина равна $d$. Докажем, что расстояние между любыми двумя точками фигуры $P$ не преводходит $d$. Действительно, если $B$ и $C$ — какие-либо две точки фигуры $P$, а $m$ и $n$ — опорные прямые, перпендикулярные к отрезку $BC$, то отрезок $BC$ не превосходит расстояния между прямыми $m$ и $n$, которое в свою очередь не превосходит $d$. Следовательно, длина $BC$ не может быть больше $d$. Ч.т.д."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Заметим, что параллельные опорные прямые можно провести не через любую пару точек."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.5.1"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 0
}
